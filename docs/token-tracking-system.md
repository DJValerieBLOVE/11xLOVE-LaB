# Token Tracking & Transparency System

## Philosophy

Users should ALWAYS know:
1. How many tokens they have
2. How much each action costs
3. What they've spent this month
4. How much value they're getting

**No hidden costs. No surprises. Complete transparency.**

---

## Token Balance Dashboard

### Main Display

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’ Your AI Credits                         â”‚
â”‚                                             â”‚
â”‚  Current Balance: 5,847 tokens              â”‚
â”‚  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 58%                â”‚
â”‚  Dollar Value: $8.77 remaining              â”‚
â”‚                                             â”‚
â”‚  Monthly Allowance: 5,000 tokens            â”‚
â”‚  Purchased Credits: 847 tokens              â”‚
â”‚  Resets: Feb 28, 2026                       â”‚
â”‚                                             â”‚
â”‚  [Buy More Credits]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Elements:**
- **Token count** (exact number)
- **Percentage bar** (visual progress)
- **Dollar value** (helps users understand worth)
- **Source breakdown** (monthly vs purchased)
- **Reset date** (when they get more tokens)

---

## This Month's Usage

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š February 2026 Usage                     â”‚
â”‚                                             â”‚
â”‚  Experiment Creation     2,347 tokens  $3.52â”‚
â”‚  Magic Mentor           1,234 tokens  $1.85 â”‚
â”‚  Profile Matching         300 tokens  $0.45 â”‚
â”‚  Quiz Generation          272 tokens  $0.41 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  Total                   4,153 tokens  $6.23â”‚
â”‚                                             â”‚
â”‚  Budget remaining: $8.77 (58%)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Shows:**
- Activity type
- Tokens used per category
- Dollar cost per category
- Running total
- Remaining budget

---

## Recent Activity Feed

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ• Recent Activity                         â”‚
â”‚                                             â”‚
â”‚  Feb 14, 2:45 PM                            â”‚
â”‚  ğŸ’¬ Magic Mentor Chat                       â”‚
â”‚  "How do I set boundaries with family?"     â”‚
â”‚  Used: 247 tokens â€¢ $0.37                   â”‚
â”‚  Remaining: 5,847 tokens                    â”‚
â”‚                                             â”‚
â”‚  Feb 14, 11:23 AM                           â”‚
â”‚  ğŸ”¬ Created Experiment                      â”‚
â”‚  "Morning Rituals for Busy Moms"            â”‚
â”‚  Used: 3,892 tokens â€¢ $5.84                 â”‚
â”‚  Remaining: 6,094 tokens                    â”‚
â”‚                                             â”‚
â”‚  Feb 13, 4:15 PM                            â”‚
â”‚  ğŸ¤ Profile Matching                        â”‚
â”‚  Matched with @sarah (Family dimension)     â”‚
â”‚  Used: 300 tokens â€¢ $0.45                   â”‚
â”‚  Remaining: 9,986 tokens                    â”‚
â”‚                                             â”‚
â”‚  [View Full History]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Each Entry Shows:**
- Timestamp
- Activity icon + type
- Description of what was done
- Tokens used + dollar cost
- Balance after this action

---

## Pre-Action Cost Preview

Before ANY AI action, show estimated cost:

### Example: Before Creating Experiment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š Estimated Cost                          â”‚
â”‚                                             â”‚
â”‚  Text-Only (5 lessons)                      â”‚
â”‚  ~3,900 tokens â€¢ $5.85                      â”‚
â”‚                                             â”‚
â”‚  Optional Add-Ons:                          â”‚
â”‚  [ ] Images (5 diagrams)                    â”‚
â”‚      +500 tokens â€¢ +$0.75                   â”‚
â”‚                                             â”‚
â”‚  [ ] Audio Narration (5 lessons)            â”‚
â”‚      +5,000 tokens â€¢ +$7.50                 â”‚
â”‚                                             â”‚
â”‚  [ ] Video Curation (free)                  â”‚
â”‚      No additional cost                     â”‚
â”‚                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  Total: 3,900 tokens â€¢ $5.85                â”‚
â”‚                                             â”‚
â”‚  Your Balance: 5,847 tokens â€¢ $8.77         â”‚
â”‚  After Creation: 1,947 tokens â€¢ $2.92       â”‚
â”‚                                             â”‚
â”‚  âš ï¸ Running low! Consider buying more.      â”‚
â”‚                                             â”‚
â”‚  [Proceed] [Buy Credits First] [Cancel]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Benefits:**
- No surprises
- User can adjust options to fit budget
- Encourages purchasing credits before running out
- Shows exact impact on balance

---

## Low Balance Warning

When user drops below 1,000 tokens:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ Low on Credits                          â”‚
â”‚                                             â”‚
â”‚  You have 847 tokens remaining ($1.27)      â”‚
â”‚                                             â”‚
â”‚  This is enough for:                        â”‚
â”‚  â€¢ 3 Magic Mentor chats                     â”‚
â”‚  â€¢ OR 1 profile match + 2 chats             â”‚
â”‚                                             â”‚
â”‚  Not enough for:                            â”‚
â”‚  â€¢ Creating a new experiment                â”‚
â”‚                                             â”‚
â”‚  ğŸ’¡ Top up now to keep learning!            â”‚
â”‚                                             â”‚
â”‚  [Buy $10 Pack] [Buy $25 Pack] [Maybe Later]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Monthly Reset Notification

On the 1st of each month:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‰ Monthly Credits Refreshed!              â”‚
â”‚                                             â”‚
â”‚  You received: 5,000 new tokens ($7.50)     â”‚
â”‚  Purchased credits: 847 tokens (carried over)â”‚
â”‚                                             â”‚
â”‚  New Balance: 5,847 tokens ($8.77)          â”‚
â”‚                                             â”‚
â”‚  Last Month's Usage:                        â”‚
â”‚  â€¢ Created 2 experiments                    â”‚
â”‚  â€¢ 15 Magic Mentor chats                    â”‚
â”‚  â€¢ 3 profile matches                        â”‚
â”‚  Total: 4,153 tokens used                   â”‚
â”‚                                             â”‚
â”‚  [Start Learning] [View Progress]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Credit Purchase Flow

### Step 1: Select Pack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’ Buy AI Credits                          â”‚
â”‚                                             â”‚
â”‚  Select a pack:                             â”‚
â”‚                                             â”‚
â”‚  â—‹ $10  â†’ 5,800 tokens                      â”‚
â”‚     (~1.5 experiments OR ~23 chats)         â”‚
â”‚                                             â”‚
â”‚  â— $25  â†’ 14,500 tokens  â­ BEST VALUE      â”‚
â”‚     (~3.7 experiments OR ~58 chats)         â”‚
â”‚                                             â”‚
â”‚  â—‹ $50  â†’ 29,000 tokens                     â”‚
â”‚     (~7.4 experiments OR ~116 chats)        â”‚
â”‚                                             â”‚
â”‚  â—‹ $100 â†’ 58,000 tokens                     â”‚
â”‚     (~14.9 experiments OR ~232 chats)       â”‚
â”‚                                             â”‚
â”‚  Credits never expire!                      â”‚
â”‚                                             â”‚
â”‚  [Continue to Payment]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 2: Confirmation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’³ Confirm Purchase                        â”‚
â”‚                                             â”‚
â”‚  Pack: $25                                  â”‚
â”‚  Credits: 14,500 tokens                     â”‚
â”‚                                             â”‚
â”‚  Current Balance: 847 tokens                â”‚
â”‚  After Purchase: 15,347 tokens              â”‚
â”‚                                             â”‚
â”‚  Payment: â€¢â€¢â€¢â€¢ 4242 (Visa)                  â”‚
â”‚                                             â”‚
â”‚  [Complete Purchase]  [Cancel]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 3: Success

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… Credits Added!                          â”‚
â”‚                                             â”‚
â”‚  +14,500 tokens                             â”‚
â”‚                                             â”‚
â”‚  New Balance: 15,347 tokens ($23.02)        â”‚
â”‚                                             â”‚
â”‚  You can now create:                        â”‚
â”‚  â€¢ ~3 full experiments (with images/audio)  â”‚
â”‚  â€¢ ~58 Magic Mentor conversations           â”‚
â”‚  â€¢ Or any combination!                      â”‚
â”‚                                             â”‚
â”‚  [Start Creating] [View Dashboard]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Full Usage History Page

Accessible from dashboard: "View Full History"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š All-Time Usage                          â”‚
â”‚                                             â”‚
â”‚  Filters: [All Time â–¼] [All Types â–¼]       â”‚
â”‚                                             â”‚
â”‚  February 2026                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  Feb 14 â€¢ Magic Mentor       247t  $0.37    â”‚
â”‚  Feb 14 â€¢ Experiment       3,892t  $5.84    â”‚
â”‚  Feb 13 â€¢ Matching           300t  $0.45    â”‚
â”‚  Feb 12 â€¢ Magic Mentor       198t  $0.30    â”‚
â”‚  ...                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  Month Total:              4,153t  $6.23    â”‚
â”‚                                             â”‚
â”‚  January 2026                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  Jan 31 â€¢ Quiz Gen           500t  $0.75    â”‚
â”‚  Jan 30 â€¢ Experiment       4,123t  $6.18    â”‚
â”‚  ...                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  Month Total:              5,234t  $7.85    â”‚
â”‚                                             â”‚
â”‚  [Export CSV] [Download Report]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Features:**
- Filterable by date range and activity type
- Exportable to CSV
- Download monthly reports
- See patterns in usage

---

## Admin Analytics (Your Backend View)

Track across ALL users:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ›ï¸ Platform AI Usage (Admin)              â”‚
â”‚                                             â”‚
â”‚  Total Active Users: 347                    â”‚
â”‚  Total Tokens Used (Feb): 1,234,567         â”‚
â”‚  Total Cost: $1,851.85                      â”‚
â”‚  Avg per User: 3,558 tokens ($5.34)         â”‚
â”‚                                             â”‚
â”‚  By Activity:                               â”‚
â”‚  Experiments: 45% (556,155t â€¢ $834.23)      â”‚
â”‚  Magic Mentor: 40% (493,827t â€¢ $740.74)     â”‚
â”‚  Matching: 10% (123,457t â€¢ $185.19)         â”‚
â”‚  Quiz Gen: 5% (61,728t â€¢ $92.59)            â”‚
â”‚                                             â”‚
â”‚  Top Users:                                 â”‚
â”‚  1. @alice - 12,345t ($18.52)               â”‚
â”‚  2. @bob - 10,234t ($15.35)                 â”‚
â”‚  3. @charlie - 9,876t ($14.81)              â”‚
â”‚                                             â”‚
â”‚  [Export Analytics] [Set Alerts]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## BYOK (Bring Your Own Key) Display

For users with their own API keys:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”‘ Using Your Own API Key                  â”‚
â”‚                                             â”‚
â”‚  Provider: Shakespeare AI                   â”‚
â”‚  Status: âœ… Connected                       â”‚
â”‚                                             â”‚
â”‚  This Month's Usage:                        â”‚
â”‚  â€¢ Tokens used: 12,345                      â”‚
â”‚  â€¢ Estimated cost: $18.52                   â”‚
â”‚    (Billed directly by Shakespeare AI)      â”‚
â”‚                                             â”‚
â”‚  Platform Fee: $15/month                    â”‚
â”‚  Next billing: Feb 28, 2026                 â”‚
â”‚                                             â”‚
â”‚  ğŸ’¡ Unlimited AI usage with your key!       â”‚
â”‚                                             â”‚
â”‚  [Disconnect Key] [View API Dashboard]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Implementation Notes

### Storage (Nostr Events)

Track usage with Nostr events (kind 30078 - application data):

```json
{
  "kind": 30078,
  "tags": [
    ["d", "ai-usage-2026-02"],
    ["type", "magic-mentor"],
    ["tokens", "247"],
    ["cost", "0.37"],
    ["description", "How do I set boundaries?"]
  ],
  "content": "",
  "created_at": 1708024500
}
```

### Real-Time Balance

Query all usage events, sum tokens, subtract from allowance + purchased credits.

### Display Logic

```typescript
// Calculate balance
const monthlyAllowance = 5000;
const purchasedCredits = getPurchasedCredits(user);
const usedThisMonth = getMonthlyUsage(user);
const totalBalance = monthlyAllowance + purchasedCredits - usedThisMonth;

// Dollar value
const dollarValue = (totalBalance * 0.0015).toFixed(2);

// Percentage
const totalAvailable = monthlyAllowance + purchasedCredits;
const percentage = Math.round((totalBalance / totalAvailable) * 100);
```

---

## Key Principles

1. **Always show cost BEFORE action**
2. **Never hide usage from users**
3. **Make dollar values prominent** (easier to understand than tokens)
4. **Warn before running out**
5. **Celebrate top-ups** (positive reinforcement)
6. **Export data** (users own their usage history)

This builds TRUST and eliminates "gotcha" moments.
